<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Gerador de Plano de Aula</title>
  <style>
    body {
      font-family: 'Times New Roman', Times, serif;
      font-size: 12px;
      line-height: 1.5;
    }
    h2, h3 {
      text-align: center;
      margin: 10px 0;
      font-size: 14px;
    }
    label {
      display: block;
      margin-top: 6px;
      font-size: 12px;
    }
    input, select, textarea, button {
      width: 100%;
      padding: 5px;
      margin-top: 3px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 12px;
    }
    button {
      background-color: #007bff;
      color: white;
      font-weight: bold;
      cursor: pointer;
      margin-top: 8px;
    }
    button:hover {
      background-color: #0056b3;
    }
    .container {
      width: 100%;
      max-width: 900px;
      margin: auto;
      background: white;
      padding: 10px;
    }
    .objectivos textarea {
      width: 100%;
      height: 100px;
      padding: 5px;
      font-size: 12px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #999;
      padding: 4px;
      text-align: left;
      vertical-align: top;
    }
    th {
      background-color: #0069d9;
      color: white;
      font-weight: bold;
      text-transform: uppercase;
    }
    .row {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .col {
      flex: 1;
      min-width: 200px;
      padding: 5px;
    }
    #avisoExportacao {
      display: none;
      text-align: center;
      font-size: 15px;
      color: red;
      font-weight: bold;
    }
    @media print {
      #mensagemAnexo,
      #selecaoTipoAnexo {
        display: none !important;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>GERADOR DE PLANO DE AULA</h2>

    <form name="planoForm" onsubmit="event.preventDefault()">
      <div class="row">
        <div class="col">
          <label>Escola:</label>
          <input type="text" name="escola" required />
          <label>Nome do Professor:</label>
          <input type="text" name="professor" required />
          <label>Disciplina:</label>
          <input type="text" name="disciplina" required />
          <label>Unidade Tem√°tica:</label>
          <input type="text" name="unidade" required />
          <label>Tema da Aula:</label>
          <input type="text" name="tema" required maxlength="100" />
          <label>Tipo de Aula:</label>
          <input type="text" name="tipo" required />
        </div>
        <div class="col">
          <select name="classe" required>
            <option value="">Selecione a classe</option>
            <option value="1">1¬™ Classe</option>
            <option value="2">2¬™ Classe</option>
            <option value="3">3¬™ Classe</option>
            <option value="4">4¬™ Classe</option>
            <option value="5">5¬™ Classe</option>
            <option value="6">6¬™ Classe</option>
            <option value="7">7¬™ Classe</option>
            <option value="8">8¬™ Classe</option>
            <option value="9">9¬™ Classe</option>
            <option value="10">10¬™ Classe</option>
            <option value="11">11¬™ Classe</option>
            <option value="12">12¬™ Classe</option>
          </select>
          <label>Turma:</label>
          <input type="text" name="turma" required />
          <label>Li√ß√£o n¬∫:</label>
          <input type="number" name="licao" min="1" step="1" />
          <label>Dura√ß√£o:</label>
          <select name="duracao" required>
            <option value="45">45 minutos</option>
            <option value="90">90 minutos</option>
          </select>
          <label>Data:</label>
          <input type="date" name="data" required />
          <label><input type="checkbox" id="usarMateriais" onchange="alternarCampoMaterial()"> Aula exige material did√°tico?</label>
          <div id="adicionarMaterialDiv" style="display:none;">
            <label>Adicionar material:</label>
            <div style="display:flex; gap:12px;">
              <input type="text" id="inputMaterial" placeholder="Ex: cartaz, marcador">
              <button type="button" onclick="adicionarMaterial()">Adicionar</button>
            </div>
            <ul id="listaMateriais" style="font-size:12px; margin-top:12px;"></ul>
          </div>
        </div>
      </div>

      <div class="objectivos">
        <label>Objetivos Espec√≠ficos:</label>
        <textarea id="objetivosCampo" name="objetivos" required></textarea>
        <div style="margin-top: 5px; display: flex; gap: 10px;">
          <button type="button" onclick="gerarObjetivosLocal()" style="background-color: #28a745; font-size: 11px; padding: 3px 8px;">Gerar Objetivos</button>
          <button type="button" onclick="gerarNovosObjetivos()" style="background-color: #ffc107; font-size: 11px; padding: 3px 8px;">üîÑ Gerar Novos</button>
        </div>
      </div>

      <button type="button" onclick="gerarPlano()">Gerar Plano de Aula</button>
    </form>

    <div id="avisoExportacao"></div>

    <div id="planoFinal" style="display:none; margin-top:20px;">
      <h3>PLANO DE AULA</h3>
      <div class="row">
        <div class="col" id="dadosEsquerda"></div>
        <div class="col" id="dadosDireita"></div>
      </div>
      <h4>Objetivos Espec√≠ficos:</h4>
      <ul id="listaObjetivos"></ul>
      <table id="tabelaPlano">
        <thead>
          <tr>
            <th>TEMPO</th>
            <th>FUN√á√ïES DID√ÅCTICAS</th>
            <th>CONTE√öDOS</th>
            <th>ACTIVIDADES DO PROFESSOR</th>
            <th>ACTIVIDADES DOS ALUNOS</th>
            <th>M√âTODOS DE ENSINO</th>
            <th>MEIOS DE ENSINO</th>
          </tr>
        </thead>
        <tbody id="tabelaCorpo"></tbody>
      </table>

      <div id="selecaoTipoAnexo" style="margin-top: 10px;">
        <label><strong>Como deseja adicionar o anexo?</strong></label>
        <select id="tipoAnexo" onchange="alternarTipoAnexo()">
          <option value="imagem">Imagem (foto do livro)</option>
          <option value="texto">Texto explicativo</option>
        </select>
      </div>

      <div id="opcaoImagem" style="margin-top: 10px;">
        <input type="file" id="inputImagem" accept="image/*" capture="environment" onchange="mostrarImagem(event)">
        <img id="visualizarImagem" src="" alt="Pr√©-visualiza√ß√£o da imagem" style="display: none; max-width: 100%; margin-top: 5px;" />
      </div>

      <div id="opcaoTexto" style="display:none; margin-top: 10px;">
        <label for="textoAnexo"><strong>Digite o conte√∫do do anexo:</strong></label>
        <textarea id="textoAnexo" placeholder="Ex: resumo do conte√∫do, exemplo do livro..." style="width:100%; height:80px;"></textarea>
      </div>
      <button onclick="irParaPagamento()">Exportar para PDF</button>
    </div>
  </div>

  <script>
    const verbosCognitivos = ["identificar", "descrever", "classificar", "definir", "explicar", "relacionar", "enumerar", "comparar", "analisar", "sintetizar"];
    const verbosPsicomotores = ["desenhar", "montar", "construir", "organizar", "manipular", "demonstrar", "executar", "medir", "simular", "experimentar"];
    const verbosAfetivos = ["valorizar", "respeitar", "cooperar", "participar", "aceitar", "comprometer-se", "defender", "refletir", "apreciar", "internalizar"];

    let materiais = [];
    let imagemDataURL = null;

    function gerarObjetivosLocal() {
      const tema = document.forms['planoForm'].tema.value.trim();
      if (!tema) {
        alert("Por favor, preencha o tema da aula primeiro.");
        return;
      }
      gerarNovosObjetivos();
    }

    function gerarNovosObjetivos() {
      const tema = document.forms['planoForm'].tema.value.trim();
      if (!tema) return;

      const verboCognitivo = verbosCognitivos[Math.floor(Math.random() * verbosCognitivos.length)];
      const verboPsicomotor = verbosPsicomotores[Math.floor(Math.random() * verbosPsicomotores.length)];
      const verboAfetivo = verbosAfetivos[Math.floor(Math.random() * verbosAfetivos.length)];

      const objetivos = `
${verboCognitivo.charAt(0).toUpperCase() + verboCognitivo.slice(1)} os conceitos fundamentais de "${tema}";
${verboPsicomotor.charAt(0).toUpperCase() + verboPsicomotor.slice(1)} uma atividade pr√°tica relacionada a "${tema}";
${verboAfetivo.charAt(0).toUpperCase() + verboAfetivo.slice(1)} a import√¢ncia de "${tema}" no contexto social.`;

      document.getElementById("objetivosCampo").value = objetivos;
    }

    function gerarPlano() {
      const form = document.forms['planoForm'];
      const tema = form.tema.value;

      document.getElementById('dadosEsquerda').innerHTML = `
        <p><strong>Escola:</strong> ${form.escola.value}</p>
        <p><strong>Professor:</strong> ${form.professor.value}</p>
        <p><strong>Disciplina:</strong> ${form.disciplina.value}</p>
        <p><strong>Unidade Tem√°tica:</strong> ${form.unidade.value}</p>
        <p><strong>Tema:</strong> ${tema}</p>
        <p><strong>Tipo de Aula:</strong> ${form.tipo.value}</p>`;

      document.getElementById('dadosDireita').innerHTML = `
        <p><strong>Classe:</strong> ${form.classe.value}</p>
        <p><strong>Turma:</strong> ${form.turma.value}</p>
        <p><strong>Li√ß√£o n¬∫:</strong> ${form.licao.value || "‚Äî"}</p>
        <p><strong>Dura√ß√£o:</strong> ${form.duracao.value} minutos</p>
        <p><strong>Data:</strong> ${form.data.value}</p>
        ${materiais.length ? `<p><strong>Materiais:</strong><br>${materiais.map(m => `‚Ä¢ ${m}`).join('<br>')}</p>` : ''}`;

      const objetivos = form.objetivos.value.trim().split('\n').map(l => `<li>${l}</li>`).join('');
      document.getElementById('listaObjetivos').innerHTML = objetivos;

      const classe = form.classe.value.toLowerCase();
      const classeLimpa = classe.replace(/[^\d]/g, '');
      const isClasseInicial = classeLimpa === '1' || classeLimpa === '2';
      const meiosEnsinoIniciais = 'Livro do aluno';
      const meiosEnsinoNormais = 'Quadro, giz, livro do aluno, esferogr√°fica';
      const duracao = parseInt(form.duracao.value);
      const fator = duracao === 90 ? 2 : 1;
      const tempo1 = `${5 * fator} min`;
      const tempo2 = `${20 * fator} min`;
      const tempo3 = `${10 * fator} min`;
      const tempo4 = `${10 * fator} min`;

      const tabela = document.getElementById('tabelaCorpo');
      tabela.innerHTML = `
        <tr>
          <td>${tempo1}</td>
          <td><strong>Introdu√ß√£o e Motiva√ß√£o</strong></td>
          <td>‚Ä¢ Sauda√ß√£o<br>‚Ä¢ Marca√ß√£o de presen√ßa<br>‚Ä¢ Recapitula√ß√£o da aula anterior<br>‚Ä¢ Apresenta√ß√£o do tema "${tema}"</td>
          <td>‚Ä¢ Sa√∫da os alunos<br>‚Ä¢ Faz a marca√ß√£o de presen√ßas<br>‚Ä¢ Orienta a recapitula√ß√£o da aula anterior<br>‚Ä¢ Introduz o tema "${tema}"</td>
          <td>‚Ä¢ Sa√∫dam o professor<br>‚Ä¢ Confirma a presen√ßa<br>‚Ä¢ Recapitulam a aula anterior sob orienta√ß√£o do professor<br>‚Ä¢ Anotam o tema</td>
          <td>Elabora√ß√£o conjunta</td>
          <td>${isClasseInicial ? meiosEnsinoIniciais : meiosEnsinoNormais}</td>
        </tr>
        <tr>
          <td>${tempo2}</td>
          <td>Media√ß√£o e Assimila√ß√£o</td>
          <td>‚Ä¢ Explora√ß√£o dos poss√≠veis pressupostos dos alunos<br>‚Ä¢ Explica√ß√£o do tema "${tema}"<br>‚Ä¢ Esclarecimento das poss√≠veis d√∫vidas</td>
          <td>‚Ä¢ Explora poss√≠veis ideias dos alunos<br>‚Ä¢ Explica o conte√∫do<br>‚Ä¢ Procura sanar as poss√≠veis d√∫vidas<br>‚Ä¢ Passa o apontamento no quadro</td>
          <td>‚Ä¢ Exp√µem as poss√≠veis ideias<br>‚Ä¢ Prestam aten√ß√£o na explica√ß√£o<br>‚Ä¢ Exp√µem as poss√≠veis d√∫vidas relacionadas ao tema<br>‚Ä¢ Transcrevem o apontamento para os seus cadernos</td>
          <td>Elabora√ß√£o conjunta</td>
          <td>${isClasseInicial ? meiosEnsinoIniciais : 'Quadro, giz, livro do aluno, cartaz'}</td>
        </tr>
        <tr>
          <td>${tempo3}</td>
          <td>Dom√≠nio e Consolida√ß√£o</td>
          <td>Exerc√≠cios sobre aplica√ß√£o</td>
          <td>‚Ä¢ Passa os exerc√≠cios no quadro<br>‚Ä¢ Orienta a resolu√ß√£o dos exerc√≠cios<br>‚Ä¢ Passa de carteira em carteira a verificar a resolu√ß√£o</td>
          <td>‚Ä¢ Transcrevem os exerc√≠cios aos cadernos<br>‚Ä¢ Resolvem os exerc√≠cios no ${isClasseInicial ? 'livro do aluno' : 'caderno'} individualmente</td>
          <td>Trabalho independente</td>
          <td>${isClasseInicial ? meiosEnsinoIniciais : 'Caderno, esferogr√°fica, livro do aluno'}</td>
        </tr>
        <tr>
          <td>${tempo4}</td>
          <td>Controlo e Avalia√ß√£o</td>
          <td>‚Ä¢ Corre√ß√£o dos exerc√≠cios<br>‚Ä¢ Breve resumo da aula<br>‚Ä¢ Marca√ß√£o do TPC</td>
          <td>‚Ä¢ Corrige os exerc√≠cios apresentados<br>‚Ä¢ Resume os pontos principais<br>‚Ä¢ Faz a marca√ß√£o o TPC</td>
          <td>‚Ä¢ Apresentam os exerc√≠cios corrigidos<br>‚Ä¢ Prestam aten√ß√£o e anotam o resumo<br>‚Ä¢ Anotam o TPC no ${isClasseInicial ? 'livro do aluno' : 'caderno'}</td>
          <td>Trabalho independente</td>
          <td>${isClasseInicial ? meiosEnsinoIniciais : 'Quadro, caderno, esferogr√°fica, apagador'}</td>
        </tr>`;

      document.getElementById('planoFinal').style.display = 'block';

      // --- SALVAR PLANO NO SESSIONSTORAGE (como JSON, n√£o HTML) ---
      const planoData = {
        escola: form.escola.value,
        professor: form.professor.value,
        disciplina: form.disciplina.value,
        unidade: form.unidade.value,
        tema: tema,
        tipo: form.tipo.value,
        classe: form.classe.value,
        turma: form.turma.value,
        licao: form.licao.value,
        duracao: form.duracao.value,
        data: form.data.value,
        materiais: [...materiais],
        objetivos: form.objetivos.value,
        tabela: tabela.innerHTML,
        anexoTipo: document.getElementById('tipoAnexo').value,
        anexoImagem: imagemDataURL,
        anexoTexto: document.getElementById('textoAnexo') ? document.getElementById('textoAnexo').value : ''
      };

      sessionStorage.setItem("planoData", JSON.stringify(planoData));

      const aviso = document.getElementById('avisoExportacao');
      aviso.textContent = "‚ö†Ô∏è Exporte o plano de aula no modo horizontal para melhor visualiza√ß√£o em PDF.";
      aviso.style.display = "block";

      setTimeout(() => {
        aviso.style.display = "none";
      }, 10000);
    }

    function mostrarImagem(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        imagemDataURL = e.target.result;
        const imgPreview = document.getElementById('visualizarImagem');
        imgPreview.src = imagemDataURL;
        imgPreview.style.display = 'block';
      };
      reader.readAsDataURL(file);
    }

    function alternarCampoMaterial() {
      document.getElementById('adicionarMaterialDiv').style.display =
        document.getElementById('usarMateriais').checked ? 'block' : 'none';
    }

    function adicionarMaterial() {
      const input = document.getElementById('inputMaterial');
      const valor = input.value.trim();
      if (valor) {
        materiais.push(valor);
        const li = document.createElement('li');
        li.textContent = valor;
        document.getElementById('listaMateriais').appendChild(li);
        input.value = '';
      }
    }

    function alternarTipoAnexo() {
      const tipo = document.getElementById("tipoAnexo").value;
      document.getElementById("opcaoImagem").style.display = tipo === "imagem" ? "block" : "none";
      document.getElementById("opcaoTexto").style.display = tipo === "texto" ? "block" : "none";
    }

    function irParaPagamento() {
      if (!sessionStorage.getItem("planoData")) {
        alert("‚ö†Ô∏è Primeiro gere o plano de aula antes de exportar.");
        return;
      }
      window.location.href = "pagamento.html";
    }
  </script>
</body>
</html>